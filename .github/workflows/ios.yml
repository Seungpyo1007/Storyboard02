name: Run Test

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  test_ios:
    # macos-latest ëŸ¬ë„ˆë¥¼ ì‚¬ìš©í•˜ë©°, ì´ ëŸ¬ë„ˆëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìµœì‹  Xcodeë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
    runs-on: macos-latest

    steps:
    # 1. Checkout the repository code (using v4, the latest version)
    - uses: actions/checkout@v4
      
    # 2. Optional: Verify the selected version (good for debugging)
    #    ì–´ë–¤ Xcode ë²„ì „ì´ ì‚¬ìš©ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
    - name: Show active Xcode version
      run: xcodebuild -version

    # 3. ë””ë²„ê¹…ì„ ìœ„í•´ í´ë¡ ëœ ì €ì¥ì†Œì˜ íŒŒì¼ êµ¬ì¡°ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤.
    #    ì´ ë¡œê·¸ë¥¼ í†µí•´ .xcodeproj ë˜ëŠ” .xcworkspace íŒŒì¼ì˜ ì •í™•í•œ ìœ„ì¹˜ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    #    ì´ ë‹¨ê³„ì˜ ë¡œê·¸ë¥¼ í†µí•´ ì •í™•í•œ ê²½ë¡œë¥¼ ìµœì¢… í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - name: List Project Structure for Debugging
      run: ls -R
      
    # 4. Run the Clean and Test command
    - name: Start xcode build and run tests ğŸ› 
      run: |
        # ğŸ’¡ ìˆ˜ì •: xcodebuild -list ëª…ë ¹ ê²°ê³¼ì— ë”°ë¼ .xcodeproj íŒŒì¼ì´ ë¦¬í¬ì§€í† ë¦¬ì˜
        # ë£¨íŠ¸ ê²½ë¡œì— ì§ì ‘ ìœ„ì¹˜í•œë‹¤ê³  ê°€ì •í•˜ê³  ê²½ë¡œë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.
        # ìŠ¤í‚´ ì´ë¦„ì€ 'Storyboard02'ë¡œ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
        xcodebuild clean test \
          -project Storyboard02.xcodeproj \
          -scheme Storyboard02 \
          -destination 'platform=iOS Simulator,name=iPhone 16 Pro,OS=latest'
