name: Run Test

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  test_ios:
    # âš ï¸ ìˆ˜ì •: macos-latestë¡œ ì˜¤íƒ€ ìˆ˜ì •
    runs-on: macos-latest

    steps:
    # 1. Checkout the repository code (using v4, the latest version)
    - uses: actions/checkout@v4
      
    # 2. Add step to list all installed Xcode applications
    # ì´ ë‹¨ê³„ë¥¼ í†µí•´ ëŸ¬ë„ˆì— ì„¤ì¹˜ëœ Xcodeì˜ ì •í™•í•œ íŒŒì¼ëª…ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - name: List Installed Xcode Versions
      run: ls -1 /Applications | grep "Xcode"

    # 3. Select a specific Xcode version using the built-in command (Most reliable method)
    # âš ï¸ ìˆ˜ì •: ì—ëŸ¬ê°€ ë°œìƒí•œ ì™¸ë¶€ ì•¡ì…˜ ëŒ€ì‹  xcode-select ëª…ë ¹ì–´ë¥¼ ì§ì ‘ ì‚¬ìš©í•©ë‹ˆë‹¤.
    # í•˜ì§€ë§Œ ìœ„ 2ë²ˆ ë‹¨ê³„ ì‹¤í–‰ í›„, ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ /Applications/ ì•„ë˜ì˜ ì •í™•í•œ Xcode íŒŒì¼ëª…ì„ 
    # ì°¾ì•„ì„œ ì•„ë˜ ëª…ë ¹ì–´ì˜ 'Xcode_15.3.app' ë¶€ë¶„ì„ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. 
    # ì¼ë‹¨ì€ ì›ë³¸ ê²½ë¡œë¥¼ ìœ ì§€í•˜ê³ , ë‹¤ìŒ ì‹¤í–‰ ë¡œê·¸ì—ì„œ ì •í™•í•œ ì´ë¦„ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    - name: Select Xcode 15.3 via xcode-select
      run: sudo xcode-select -s /Applications/Xcode_15.3.app/Contents/Developer
    
    # Optional: Verify the selected version (good for debugging)
    - name: Show active Xcode version
      run: xcodebuild -version

    # 4. Run the Clean and Test command
    - name: Start xcode build and run tests ğŸ› 
      run: |
        xcodebuild clean test \
          # âš ï¸ ìˆ˜ì •: í”„ë¡œì íŠ¸ ì´ë¦„ê³¼ ìŠ¤í‚´ ì´ë¦„ì„ 'Storyboard02'ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.
          -project Storyboard02/Storyboard02.xcodeproj \
          -scheme Storyboard02 \
          -destination 'platform=iOS Simulator,name=iPhone 15 Pro,OS=latest'
